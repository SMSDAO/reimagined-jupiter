name: Stale Issues and PRs

on:
  schedule:
    # Run daily at 00:00 UTC
    - cron: '0 0 * * *'
  workflow_dispatch:

permissions:
  issues: write
  pull-requests: write

jobs:
  stale:
    name: Mark Stale Issues and PRs
    runs-on: ubuntu-latest
    
    steps:
      - name: Mark stale issues and PRs
        uses: actions/stale@v9
        with:
          repo-token: ${{ secrets.GITHUB_TOKEN }}
          
          # Issue configuration
          days-before-issue-stale: 60
          days-before-issue-close: 14
          stale-issue-message: |
            This issue has been automatically marked as stale because it has not had recent activity. 
            It will be closed in 14 days if no further activity occurs.
            
            If this issue is still relevant, please:
            - Add a comment explaining why it should remain open
            - Remove the `stale` label
            - Update the issue with current information
            
            Thank you for your contributions! üôè
          stale-issue-label: 'stale'
          exempt-issue-labels: 'pinned,security,high-priority'
          close-issue-message: |
            This issue has been automatically closed due to inactivity.
            
            If you believe this issue should be reopened, please create a new issue with:
            - A link to this closed issue
            - Updated information about why it's still relevant
            - Any new context or developments
          
          # PR configuration
          days-before-pr-stale: 30
          days-before-pr-close: 7
          stale-pr-message: |
            This pull request has been automatically marked as stale because it has not had recent activity.
            It will be closed in 7 days if no further activity occurs.
            
            If this PR is still relevant, please:
            - Rebase on the latest `main` branch
            - Resolve any merge conflicts
            - Ensure all CI checks pass
            - Request a review
            - Remove the `stale` label
            
            Thank you for your contribution! üöÄ
          stale-pr-label: 'stale'
          exempt-pr-labels: 'pinned,security,high-priority,auto-merge'
          close-pr-message: |
            This pull request has been automatically closed due to inactivity.
            
            If you'd like to continue working on this:
            1. Create a new branch from the latest `main`
            2. Cherry-pick your commits or reapply changes
            3. Open a new PR with updated information
            
            We appreciate your effort and welcome you to resubmit! üíö
          
          # Additional settings
          operations-per-run: 100
          remove-stale-when-updated: true
          ascending: true
          
          # Ignore draft PRs
          exempt-draft-pr: true
